<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/principal-fragment}">
    <div class="content" layout:fragment="content">
        <div class="row">
            <div class="col-md">
                <div class="card ">
                    <div class="card-header card-header-rose card-header-text">
                        <div class="card-text">
                            <h4 class="card-title">[[#{page.title.vehicles.add}]]</h4>
                        </div>
                    </div>
                    <form class="form"  method="post" th:action="@{save}">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-sm">
                                    <div class="row">
                                        <label class="col-sm-2 col-form-label">[[#{label.vehicles.group}]]</label>
                                        <div class="dropdown bootstrap-select">
                                            <select class="selectpicker" name="vcl_group" id="vcl_group" data-size="7" data-style="btn btn-rose btn-round" title="Single Select" tabindex="-98">
                                                <option class="bs-title-option" value=""></option>
                                                <option disabled="" selected="">[[#{label.general.select}]]</option>
                                                <div th:each="g : ${groups}">
                                                    <option th:value="${g.grpCode}">[[${g.grpDesc}]]</option>
                                                </div>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <label class="col-sm-2 col-form-label">[[#{label.vehicles.name}]]</label>
                                        <div class="col-sm-10">
                                            <div class="form-group bmd-form-group">
                                                <input type="password" name="vcl_name" id="vcl_name" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <label class="col-sm-2 col-form-label">[[#{label.vehicles.plaque}]]</label>
                                        <div class="col-sm-10">
                                            <div class="form-group bmd-form-group">
                                                <input type="text" name="vcl_plaque" id="vcl_plaque" class="form-control" placeholder="XXX-0000">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <label class="col-sm-2 col-form-label">[[#{label.vehicles.status}]]</label>
                                        <div class="dropdown bootstrap-select">
                                            <select class="selectpicker" name="vcl_status" id="vcl_status" data-size="7" data-style="btn btn-rose btn-round" title="Single Select" tabindex="-98"><option class="bs-title-option" value=""></option>
                                                <option disabled="" selected="">[[#{label.general.select}]]</option>
                                                <div th:each="s : ${status}">
                                                    <option th:value="${s.stsCode}">[[${s.stsName}]]</option>
                                                </div>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="fileinput fileinput-new pull-right text-center" data-provides="fileinput">
                                        <div class="fileinput-new thumbnail">
                                            <img src="/img/image_placeholder.jpg" alt="..." style="width: 200px; height: auto;">
                                        </div>
                                        <div class="fileinput-preview fileinput-exists thumbnail"></div>
                                        <div>
                                            <span class="btn btn-rose btn-round btn-file">
                                                <span class="fileinput-new">[[#{label.vehicles.select.image}]]</span>
                                                <span class="fileinput-exists">[[#{label.vehicles.change}]]</span>
                                                <input type="file" name="vcl_photo" id="vcl_photo" accept=".jpeg,.jpg,.png,.gif" onchange="enviarArquivo()">
                                            </span>
                                            <a href="" class="btn btn-danger btn-round fileinput-exists" data-dismiss="fileinput"><i class="fa fa-times"></i> Remove</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <a th:href="@{list}" class="btn-default btn">[[#{label.button.cancel}]]</a>
                            <button th:type="submit" class="btn-rose btn">[[#{message.title.users}]]</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <script>
            /*
            TODO - envio de foto
            function enviarArquivo() {
                var fileSize = document.getElementById("file").files[0].size;
                var fileMaxSize = [(${tamanhoMaximoArquivo})];

                if(fileSize > fileMaxSize){
                    swal("[(#{mensagem.ops.simples})]", '[(#{mensagem.erro.arquivo.tamanho.excedido})]' + ' ' + fileMaxSize / 1024 + 'Kb', "error");
                    return;
                }


                var formData = new FormData($("#fileForm")[0]);
                formData.append('tipoDocumento', tipoDocumento);
                formData.append('entidade', entidade);
                formData.append('tipoEntidade', tipoEntidade)
                formData.append('sequencia', sequencia)

                $.ajax({
                    url : '/enviarArquivo',
                    type : 'post',
                    data : formData,
                    headers : {
                        '[(${_csrf.headerName})]' : '[(${_csrf.token})]'
                    },
                    enctype : 'multipart/form-data',
                    processData : false,
                    contentType : false,
                    cache : false,
                    success : function(data) {
                        document.getElementById("file").value = ""

                        $('#upload').modal('hide');
                        $('#uploaded').modal('hide');

                        if (data.result == "false") {
                            swal("[(#{mensagem.ops.simples})]", data.message, "error");
                            return;
                        }

                        var inputId = tipoDocumento + '-' + entidade;
                        if (sequencia != null) {
                            inputId = tipoDocumento + '-' + entidade + '-' + sequencia;
                        }
                        var inputElement = document.getElementById(inputId);
                        inputElement.setAttribute("class", "btn btn-success invert")
                        inputElement.href = "#uploaded";
                        inputElement.children[0].innerHTML = '[(#{rotulo.botao.enviado.arquivo})]';
                    },
                    error : function(result) {
                        document.getElementById("file").value = ""
                        console.log("error")
                    }
                });
            }
            */
        </script>
    </div>
</html>